<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Play Perl</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <link href="vendors/bootstrap/css/bootstrap.css" rel="stylesheet">
    <link href="vendors/fontawesome/css/font-awesome.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the bottom of the topbar */
      }
    </style>
    <link href="vendors/bootstrap/css/bootstrap-responsive.css" rel="stylesheet">
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link href="css/common.css" rel="stylesheet">

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="vendors/bootstrap/ico/favicon.ico">
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="vendors/bootstrap/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="vendors/bootstrap/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="vendors/bootstrap/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="vendors/bootstrap/ico/apple-touch-icon-57-precomposed.png">

    <!-- notification messages -->
    <script type="text/template" id="template-error">
        <div class="alert alert-error">
          <button type="button" class="close" data-dismiss="alert">×</button>
          <% if (response && response.error) { %>
            <%= response.error %>
          <% } else { %>
            Unknown error
          <% } %>
        </div>
    </script>

    <script type="text/template" id="template-notify">
        <div class="alert alert-notify">
          <button type="button" class="close" data-dismiss="alert">×</button>
          <%= text %>
        </div>
    </script>

    <!-- main container with navbar -->
    <script type="text/template" id="template-app">
        <div class="navbar navbar-inverse navbar-fixed-top">
          <div class="navbar-inner">
            <div class="container">
              <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </a>
              <a class="brand" href="#">Play Perl</a>
              <div class="nav-collapse collapse">
                <ul class="nav">
                  <li class="active menu-item-home"><a href="#">Home</a></li>
                  <li class="menu-item-user-list"><a href="#players">User List</a></li>
                </ul>
                <p class="navbar-text pull-right"></p>
                    <ul class="nav pull-right current-user-box">
                    </ul>
              </div><!--/.nav-collapse -->
            </div>
          </div>
        </div>
        <div class="app-view-container container"></div>
    </script>

    <!-- current user widget from right-top corner -->
    <script type="text/template" id="template-current-user">
        <li class="dropdown">
            <% if (registered === 1) { %>
                <a href="#" class="dropdown-toggle" data-toggle="dropdown"><%= login %></a>
                <ul class="dropdown-menu">
                    <li>
                        <a href="#" class="logout">Logout</a>
                    </li>
                </ul>
            <% } else { %>
                <a href="/auth/twitter">Login with <i class="icon-twitter icon-large"></i></a>
            <% } %>
        </li>
    </script>

    <!-- landing page -->
    <script type="text/template" id="template-home">
      <div>
      <h1>Play Perl</h1>
      <h2>What&apos;s going on here?</h2>
      <p>
        <ol>
            <li>This is your public to-do list.</li>
            <li>This is a gamified platform for connecting and encouraging people.</li>
            <li>This is a social network for Perl developers.</li>
            <li>This is a place to gather and provide feedback on the stuff you did and on the stuff you&apos;re going to do.</li>
            <li>Finally, you can get game points here!</li>
        </ol>
      </p>
      </div>
    </script>

    <!-- profile page - user and his/her quests -->
    <script type="text/template" id="template-dashboard">
      <div class="container-fluid">
        <div class="row-fluid">
            <div class="span3">
                <div class="user"></div>
                <div class="new-quest" style="display:none">
                    <button type="button" class="btn btn-primary quest-add-dialog">New quest</button>
                </div>
            </div>
          <div class="span9">
            <div class="open-quests"></div>
            <div class="closed-quests"></div>
          </div>
        </div>
      </div>
    </script>

    <script type="text/template" id="template-user-big">
      <div class="well">
        <% if (typeof(twitter) != 'undefined') {
             if (twitter.screen_name) { %>
        <img src="http://api.twitter.com/1/users/profile_image?screen_name=<%= twitter.screen_name %>&size=bigger" width=73 height=73/>
        <% } } %>
        <h4>
          <%= login %>
          <span class="badge badge-info"><%= points %></span>
        </h4>
      </div>
    </script>

    <script type="text/template" id="template-quest-collection">
        <div>
          <table class="table table-bordered quests-list" style="display: none"></table>
        </div>
    </script>

    <script type="text/template" id="template-quest-small">
        <tr class="<%= status === 'open' && 'warning' %>">
            <td>
                <span class="label label-<%= status === 'open' && 'warning' %>"><%= status %></span>
                <a href="#quest/<%= _id %>"><%= name  %></a>
                <% if (typeof(type) != 'undefined') { %>
                <span class="label label-inverse quest-type-label"><%= type %></span>
                <% } %>
            </td>
        </tr>
    </script>

    <!-- registration form -->
    <script type="text/template" id="template-register">
      <div>
        Choose your name:
        <input name="login" type="text" placeholder="Choose your login">
        <button class="btn btn-primary btn-large submit">Register</button>
      </div>
    </script>

    <!-- users list -->
    <script type="text/template" id="template-user-collection">
        <div>
          <table class="table table-bordered quests-list">
          <% users.each(function(user) { %>
            <tr>
              <td>
                <% if (user.get("twitter") && user.get("twitter").screen_name) { %>
                <img src="http://api.twitter.com/1/users/profile_image?screen_name=<%= user.get("twitter").screen_name %>&size=mini"/>
                <% } %>
                <a href="#player/<%= user.get("login") %>"><%= user.get("login") %></a>
              </td>
            </tr>
          <% }); %>
          </table>
        </div>
    </script>

    <script type="text/template" id="template-quest-add">
        <div>
      <div id="addQuest" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
          <h3>Add a quest</h3>
        </div>
        <div class="modal-body modal-quest-add">
          <textarea name="name" rows="5" placeholder="Quest description" class="span12"></textarea>
          <div class="btn-group quest-type-select">
            <button type="button" class="btn" quest-type="bug">Bug</button>
            <button type="button" class="btn" quest-type="blog">Blog post</button>
            <button type="button" class="btn" quest-type="feature">New feature</button>
            <button type="button" class="btn" quest-type="other">Other</button>
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-primary quest-add">Go!</button>
        </div>
      </div>
        </div>
    </script>

    <!-- quest details page -->
    <script type="text/template" id="template-quest-page">
      <div class="quest"></div>
      <div class="comments"></div>
    </script>

    <script type="text/template" id="template-quest-big">
      <h1>
        <span class="label label-<%= status === 'open' && 'warning' %>"><%= status %></span>
        <span class="label label-inverse"><%= type %></span>
        <%= name %>
      <% if (my) { %>
        <a
            href="https://twitter.com/share"
            class="twitter-share-button"
            data-lang="en"
            data-url="http://play-perl.org/#quest/<%= _id %>"
            data-text="<% if (status === 'open') { %>I've got the new quest:<% } else { %>I've completed the quest:<% } %> <%= name %>" data-hashtags="playperl">Tweet</a>
      <% } %>
      </h1>
      <% if (my) { %> <!-- quest belongs to the current user -->

        <!-- close/reopen button -->
        <div>
        <% if (status === 'open') { %>
          <button class="quest-close btn">Close</button>
        <% } %>
          <% if (status === 'closed') { %>
        <button class="quest-reopen btn">Reopen</button>
        <% } %>
        </div>

        <!-- delete button -->
        <div>
          <button class="quest-delete btn">Delete</button>
        </div>

      <% } %>

      <!-- likes count -->
      <% if (likes.length) { %>
      <div>
        Likes: <span class="label"><%= likes.length %></span>
      </div>
      <% } %>

      <% if (!my) {
        var meGusta = false;
        if (currentUser) {
          meGusta = _.contains(likes, currentUser);
        }
      %> <!-- quest belongs to somebody else -->


        <!-- like/unlike button  -->
        <% if (meGusta) { %>
          <button class="btn btn-mini btn-primary quest-unlike" type="button">Unlike</button>
        <% } else { %>
          <button class="btn btn-mini btn-primary quest-like" type="button">Like</button>
        <% } %>

      <% } %>
    </script>

    <script type="text/template" id="template-comment-collection">
      <div class="comments-list" style="display:none">
      </div>
      <div class="comment-add">
        <textarea name="comment" rows="3" placeholder="Comment" class="span6"></textarea>
        <div>
          <button class="btn btn-primary btn-large submit disabled">Add comment</button>
        </div>
      </div>
    </script>

    <script type="text/template" id="template-comment">
      <div class="well well-small">
        <%= body %> &mdash; <a href="#player/<%= author %>" class="label"><%= author %></a>
        <% if (my) { %>
        <button type="button" class="close comment-delete" data-dismiss="modal">&times;</button>
        <% } %>
      </div>
    </script>

    <!-- Google Analytics -->
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-36251424-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
     </script>

  </head>

  <body>
    <div id="layout"></div>

    <script src="vendors/jquery-1.7.1.min.js"></script>
    <script src="vendors/bootstrap/js/bootstrap.min.js"></script>
    <script src="vendors/underscore-min.js"></script>
    <script src="vendors/backbone-min.js"></script>
    <script src="vendors/jquery.cookie.js"></script>

    <script>
        var pp = {
            app: {},
            models: {},
            views: {}
        };
    </script>

    <script src="views/app.js"></script>
    <script src="views/comment/collection.js"></script>
    <script src="views/comment/normal.js"></script>
    <script src="views/dashboard.js"></script>
    <script src="views/error.js"></script>
    <script src="views/home.js"></script>
    <script src="views/notify.js"></script>
    <script src="views/quest/add.js"></script>
    <script src="views/quest/big.js"></script>
    <script src="views/quest/collection.js"></script>
    <script src="views/quest/page.js"></script>
    <script src="views/quest/small.js"></script>
    <script src="views/register.js"></script>
    <script src="views/user/big.js"></script>
    <script src="views/user/collection.js"></script>
    <script src="views/user/current.js"></script>

    <script src="models/user.js"></script>
    <script src="models/another-user.js"></script>
    <script src="models/current-user.js"></script>
    <script src="models/user-collection.js"></script>
    <script src="models/comment.js"></script>
    <script src="models/comment-collection.js"></script>
    <script src="models/quest.js"></script>
    <script src="models/quest-collection.js"></script>

    <script src="app.js"></script>

  </body>
</html>
